<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Performs a plethora of set enrichment analyses over varied inputs. — seas • sparrow</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Performs a plethora of set enrichment analyses over varied inputs. — seas"><meta property="og:description" content='This is a wrapper function that delegates GSEA analyses to different
"workers", each of which implements the flavor of GSEA of your choosing.
The particular analyses that are performed are specified by the
methods argument, and these methods are fine tuned by passing their
arguments down through the ... of this wrapper function.'><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sparrow</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.9.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/sparrow.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/WIP/adding-new-methods-to-sparrow.html">Adding new methods to sparrow</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/lianos/sparrow/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Performs a plethora of set enrichment analyses over varied inputs.</h1>
    <small class="dont-index">Source: <a href="https://github.com/lianos/sparrow/blob/HEAD/R/seas.R" class="external-link"><code>R/seas.R</code></a></small>
    <div class="hidden name"><code>seas.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This is a wrapper function that delegates GSEA analyses to different
"workers", each of which implements the flavor of GSEA of your choosing.
The particular analyses that are performed are specified by the
<code>methods</code> argument, and these methods are fine tuned by passing their
arguments down through the <code>...</code> of this wrapper function.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">seas</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">gsd</span>,</span>
<span>  methods <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  design <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  contrast <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  use.treat <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  feature.min.logFC <span class="op">=</span> <span class="kw">if</span> <span class="op">(</span><span class="va">use.treat</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log2</a></span><span class="op">(</span><span class="fl">1.25</span><span class="op">)</span> <span class="kw">else</span> <span class="fl">1</span>,</span>
<span>  feature.max.padj <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  trim <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  score.by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"t"</span>, <span class="st">"logFC"</span>, <span class="st">"pval"</span><span class="op">)</span>,</span>
<span>  rank_by <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  rank_order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ordered"</span>, <span class="st">"descending"</span>, <span class="st">"ascending"</span><span class="op">)</span>,</span>
<span>  xmeta. <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  BPPARAM <span class="op">=</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/SerialParam-class.html" class="external-link">SerialParam</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p>An object to run enrichment analyses over. This can be an
ExpressoinSet-like object that you can differential expression over
(for roast, fry, camera), a named (by feature_id) vector of scores to run
ranked-based GSEA, a data.frame with feature_id's, ranks, scores, etc.</p></dd>


<dt>gsd</dt>
<dd><p>The <code><a href="GeneSetDb-class.html">GeneSetDb()</a></code> that defines the gene sets of interest.</p></dd>


<dt>methods</dt>
<dd><p>A character vector indicating the GSEA methods you want to
run. Refer to the GSEA Methods section for more details.
If no methods are specified, only differential gene expression and geneset
level statistics for the contrast are computed.</p></dd>


<dt>design</dt>
<dd><p>A design matrix for the study</p></dd>


<dt>contrast</dt>
<dd><p>The contrast of interest to analyze. This can be a column
name of <code>design</code>, or a contrast vector which performs "coefficient
arithmetic" over the columns of <code>design</code>. The <code>design</code> and <code>contrast</code>
parameters are interpreted in <em>exactly</em> the same way as the same parameters
in limma's <code><a href="https://rdrr.io/pkg/limma/man/camera.html" class="external-link">limma::camera()</a></code> and <code><a href="https://rdrr.io/pkg/limma/man/roast.html" class="external-link">limma::roast()</a></code> methods.</p></dd>


<dt>use.treat</dt>
<dd><p>should we use limma/edgeR's "treat" functionality for the
gene-level differential expression analysis?</p></dd>


<dt>feature.min.logFC</dt>
<dd><p>The minimum logFC required for an individual
feature (not geneset) to be considered differentialy expressed. Used in
conjunction with <code>feature.max.padj</code> primarily for summarization
of genesets (by <code><a href="geneSetsStats.html">geneSetsStats()</a></code>, but can also be used by GSEA methods
that require differential expression calls at the individual feature level,
like <code><a href="goseq.html">goseq()</a></code>.</p></dd>


<dt>feature.max.padj</dt>
<dd><p>The maximum adjusted pvalue used to consider an
individual feature (not geneset) to be differentially expressed. Used in
conjunction with <code>feature.min.logFC</code>.</p></dd>


<dt>trim</dt>
<dd><p>The amount to trim when calculated trimmed <code>t</code> and
<code>logFC</code> statistics for each geneset. This is passed down to the
<code><a href="geneSetsStats.html">geneSetsStats()</a></code> function.</p></dd>


<dt>verbose</dt>
<dd><p>make some noise during execution?</p></dd>


<dt>...</dt>
<dd><p>The arguments are passed down into
<code><a href="calculateIndividualLogFC.html">calculateIndividualLogFC()</a></code> and the various geneset analysis functions.</p></dd>


<dt>score.by</dt>
<dd><p>This tells us how to rank the features after differential
expression analysis when <code>x</code> is an expression container. It specifies the
name of the column to use downstream of a differential expression analysis
over <code>x</code>. If <code>x</code> is a data.frame that needs to be ranked, see <code>rank_by</code>.</p></dd>


<dt>rank_by</dt>
<dd><p>Only works when <code>x</code> is a data.frame-like input. The name of a
column that should be used to rank the features in <code>x</code> for pre-ranked gsea
tests like cameraPR or fgsea.  <code>rank_by</code> overrides <code>score.by</code></p></dd>


<dt>rank_order</dt>
<dd><p>Only used when <code>x</code> is a data.frame-like input. Specifies
how the features in <code>x</code> should be used to rank the features in <code>x</code> using
the <code>rank_by</code> column. Accepted values are:
<code>"ordered"</code> (default) means that the rows in <code>x</code> are pre-ranked already.
<code>"descendeing"</code>, and <code>"ascending"</code>.</p></dd>


<dt>xmeta.</dt>
<dd><p>A hack to support data.frame inputs for <code>x</code>. End users should
not use this.</p></dd>


<dt>BPPARAM</dt>
<dd><p>a <em>BiocParallel</em> parameter definition, like one generated from
<code><a href="https://rdrr.io/pkg/BiocParallel/man/MulticoreParam-class.html" class="external-link">BiocParallel::MulticoreParam()</a></code>, or <code><a href="https://rdrr.io/pkg/BiocParallel/man/BatchtoolsParam-class.html" class="external-link">BiocParallel::BatchtoolsParam()</a></code>,
for instance, which is passed down to BiocParallel::bplapply()]. Default
is set to <code><a href="https://rdrr.io/pkg/BiocParallel/man/SerialParam-class.html" class="external-link">BiocParallel::SerialParam()</a></code></p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A <code><a href="SparrowResult.html">SparrowResult()</a></code> which holds the results of all the analyses
specified in the <code>methods</code> parameter.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>Set enrichment analyses can either be performed over an expression object,
which requires the specification of the experiment design and contrast of
interest, or over a set of features to rank (stored as a data.frame or
vector).</p>
<p>Note that we are currently in the middle of a refactor to accept and fully
take advantage of <code>data.frame</code> as inputs for <code>x</code>, which will be used for
preranked type of GSEA methods. See the following issue for more details:
https://github.com/lianos/multiGSEA/issues/24</p>
<p>The bulk of the GSEA methods currently available in this package come from
edgeR/limma, however others are included (and are being added), as well.
<em>GSEA Methods</em> and <em>GSEA Method Parameterization</em> sections for more details.</p>
<p>In addition to performing GSEA, this function also internally orchestrates
a differential expression analysis, which can be tweaked by identifying
the parameters in the <code><a href="calculateIndividualLogFC.html">calculateIndividualLogFC()</a></code> function, and
passing them down through <code>...</code> here. The results of the differential
expression analysis (ie. the <code><a href="https://rdrr.io/pkg/limma/man/toptable.html" class="external-link">limma::topTable()</a></code>) are accessible by calling
the <code><a href="logFC.html">logFC()</a></code> function on the <code><a href="SparrowResult.html">SparrowResult()</a></code> object returned from this
function call.</p>
<p><strong>Please Note</strong>: be sure to cite the original GSEA method when using
results generated from this function.</p>
    </div>
    <div id="gsea-methods">
    <h2>GSEA Methods</h2>
    

<p>You can choose the methods you would like to run by providing a character
vector of GSEA method names to the <code>methods</code> parameter. Valid methods
you can select from include:</p><ul><li><p><code>"camera"</code>: from <code><a href="https://rdrr.io/pkg/limma/man/camera.html" class="external-link">limma::camera()</a></code> (*)</p></li>
<li><p><code>"cameraPR"</code>: from <code><a href="https://rdrr.io/pkg/limma/man/camera.html" class="external-link">limma::cameraPR()</a></code></p></li>
<li><p><code>"ora"</code>: overrepresentation analysis optionally accounting for bias
(<code><a href="ora.html">ora()</a></code>). This method is a wrapper function that makes the functionality
in <code><a href="https://rdrr.io/pkg/limma/man/goana.html" class="external-link">limma::kegga()</a></code> available to an arbitrary GeneSetDb.</p></li>
<li><p><code>"roast"</code>: from <code><a href="https://rdrr.io/pkg/limma/man/roast.html" class="external-link">limma::roast()</a></code> (*)</p></li>
<li><p><code>"fry"</code>: from <code><a href="https://rdrr.io/pkg/limma/man/roast.html" class="external-link">limma::fry()</a></code> (*)</p></li>
<li><p><code>"romer"</code>: from <code><a href="https://rdrr.io/pkg/limma/man/romer.html" class="external-link">limma::romer()</a></code> (*)</p></li>
<li><p><code>"geneSetTest"</code>: from <code><a href="https://rdrr.io/pkg/limma/man/geneSetTest.html" class="external-link">limma::geneSetTest()</a></code></p></li>
<li><p><code>"goseq"</code>: from <code>goseq::goseq()</code></p></li>
<li><p><code>"fgsea"</code>: from <code><a href="https://rdrr.io/pkg/fgsea/man/fgsea.html" class="external-link">fgsea::fgsea()</a></code></p></li>
</ul><p>Methods annotated with a <code>(*)</code> indicate that these methods require
a complete expression object, a valid design matrix, and a contrast
specification in order to run. These are all of the same things you need to
provide when performing a vanilla differential gene expression analysis.</p>
<p>Methods missing a <code>(*)</code> can be run on a feature-named input vector
of gene level statistics which will be used for ranking (ie. a named vector
of logFC's or t-statistics for genes). They can also be run by providing
an expression, design, and contrast vector, and the appropriate statistics
vector will be generated internally from the t-statistics, p-values, or
log-fold-changes, depending on the value provided in the <code>score.by</code>
parameter.</p>
<p>The worker functions that execute these GSEA methods are functions named
<code>do.METHOD</code> within this package. These functions are not meant to be executed
directly by the user, and are therefore not exported. Look at the respective
method's help page (ie. if you are running <code>"camera"</code>, look at the
<code><a href="https://rdrr.io/pkg/limma/man/camera.html" class="external-link">limma::camera()</a></code> help page for full details. The formal parameters that
these methods take can be passed to them via the <code>...</code> in this <code>seas()</code>
function.</p>
    </div>
    <div id="gsea-method-parameterization">
    <h2>GSEA Method Parameterization</h2>
    


<p>Each GSEA method can be tweaked via a custom set of parameters. We leave the
documentation of these parameters and how they affect their respective GSEA
methods to the documentation available in the packages where they are
defined. The <code>seas()</code> call simply has to pass these parameters down
into the <code>...</code> parameters here. The <code>seas</code> function will then pass these
along to their worker functions.</p>
<p><strong>What happens when two different GSEA methods have parameters with the
same name?</strong></p>
<p>Unfortunately you currently cannot provide different values for these
parameters. An upcoming version version of sparrow will support this
feature via slightly different calling semantics. This will also allow the
caller to call the same GSEA method with different parameterizations so that
even these can be compared against each other.</p>
    </div>
    <div id="differential-gene-expression">
    <h2>Differential Gene Expression</h2>
    


<p>When the <code>seas()</code> call is given an expression matrix, design, and
contrast, it will also internally orchestrate a gene level differential
expression analysis. Depending on the type of expression object passed in
via <code>x</code>, this function will guess on the best method to use for this
analysis.</p>
<p>If <code>x</code> is a <code>DGEList</code>, then ensure that you have already called
<code><a href="https://rdrr.io/pkg/edgeR/man/estimateDisp.html" class="external-link">edgeR::estimateDisp()</a></code> on <code>x</code> and edgeR's quasilikelihood framework will be
used, otherwise we'll use limma (note that <code>x</code> can be an <code>EList</code> run through
<code>voom()</code>, <code>voomWithQuailityWeights()</code>, or when where you have leveraged
limma's <code><a href="https://rdrr.io/pkg/limma/man/dupcor.html" class="external-link">limma::duplicateCorrelation()</a></code> functionality, even.</p>
<p>The parameters of this differential expression analysis can also be
customized. Please refer to the <code><a href="calculateIndividualLogFC.html">calculateIndividualLogFC()</a></code> function for
more information. The <code>use.treat</code>, <code>feature.min.logFC</code>,
<code>feature.max.padj</code>, as well as the <code>...</code> parameters from this function are
passed down to that funciton.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">vm</span> <span class="op">&lt;-</span> <span class="fu"><a href="examples.html">exampleExpressionSet</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">gdb</span> <span class="op">&lt;-</span> <span class="fu"><a href="examples.html">exampleGeneSetDb</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mg</span> <span class="op">&lt;-</span> <span class="fu">seas</span><span class="op">(</span><span class="va">vm</span>, <span class="va">gdb</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'camera'</span>, <span class="st">'fry'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>           design <span class="op">=</span> <span class="va">vm</span><span class="op">$</span><span class="va">design</span>, contrast <span class="op">=</span> <span class="st">'tumor'</span>,</span></span>
<span class="r-in"><span>           <span class="co"># customzie camera parameter:</span></span></span>
<span class="r-in"><span>           inter.gene.cor <span class="op">=</span> <span class="fl">0.04</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="results.html">resultNames</a></span><span class="op">(</span><span class="va">mg</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "camera" "fry"   </span>
<span class="r-in"><span><span class="va">res.camera</span> <span class="op">&lt;-</span> <span class="fu"><a href="results.html">result</a></span><span class="op">(</span><span class="va">mg</span>, <span class="st">'camera'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res.fry</span> <span class="op">&lt;-</span> <span class="fu"><a href="results.html">result</a></span><span class="op">(</span><span class="va">mg</span>, <span class="st">'fry'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res.all</span> <span class="op">&lt;-</span> <span class="fu"><a href="results.html">results</a></span><span class="op">(</span><span class="va">mg</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Steve Lianoglou, Aratus Informatics, LLC, Denali Therapeutics, Genentech.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

