<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>A container for geneset definitions. — GeneSetDb-class • sparrow</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="A container for geneset definitions. — GeneSetDb-class"><meta property="og:description" content="Please refer to the sparrow vignette (vignette(&quot;sparrow&quot;)),
(and the &quot;The GeneSetDb Class&quot; section, in particular) for a more deatiled
description of the sematnics of this central data object.
The GeneSetDb class serves the same purpose as the
GSEABase::GeneSetCollection() class does: it acts as a centralized
object to hold collections of Gene Sets. The reason for its existence is
because there are things that I wanted to know about my gene set
collections that weren't easily inferred from what is essentially a
&quot;list of GeneSets&quot; that is the GeneSetCollection class.
Gene Sets are internally represented by a data.table in &quot;a tidy&quot;
format, where we minimally require non NA values for the following
three character columns:
collection
name
feature_id


The (collection, name) compound key is the primary key of a gene set.
There will be as many entries with the same (collection, name) as there
are genes/features in that set.
The GeneSetDb tracks metadata about genesets at the collection
level. This means that we assume that all of the feature_id's used
within a collection use the same type of feature identifier (such as
a GSEABase::EntrezIdentifier(), were defined in the same organism,
etc.
Please refer to the &quot;GeneSetDb&quot; section of the vignette for more
details regarding the construction and querying of a GeneSetDb object."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sparrow</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.1.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/sparrow.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/WIP/adding-new-methods-to-sparrow.html">Adding new methods to sparrow</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/lianos/sparrow/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>A container for geneset definitions.</h1>
    <small class="dont-index">Source: <a href="https://github.com/lianos/sparrow/blob/HEAD/R/AllClasses.R" class="external-link"><code>R/AllClasses.R</code></a>, <a href="https://github.com/lianos/sparrow/blob/HEAD/R/GeneSetDb-class.R" class="external-link"><code>R/GeneSetDb-class.R</code></a></small>
    <div class="hidden name"><code>GeneSetDb-class.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Please refer to the sparrow vignette (<code><a href="../articles/sparrow.html">vignette("sparrow")</a></code>),
(and the "The GeneSetDb Class" section, in particular) for a more deatiled
description of the sematnics of this central data object.</p>
<p>The GeneSetDb class serves the same purpose as the
<code><a href="https://rdrr.io/pkg/GSEABase/man/GeneSetCollection-methods.html" class="external-link">GSEABase::GeneSetCollection()</a></code> class does: it acts as a centralized
object to hold collections of Gene Sets. The reason for its existence is
because there are things that I wanted to know about my gene set
collections that weren't easily inferred from what is essentially a
"list of GeneSets" that is the <code>GeneSetCollection</code> class.</p>
<p>Gene Sets are internally represented by a <code>data.table</code> in "a tidy"
format, where we minimally require non <code>NA</code> values for the following
three <code>character</code> columns:</p><ul><li><p>collection</p></li>
<li><p>name</p></li>
<li><p>feature_id</p></li>
</ul><p>The (<code>collection</code>, <code>name</code>) compound key is the primary key of a gene set.
There will be as many entries with the same (<code>collection</code>, <code>name</code>) as there
are genes/features in that set.</p>
<p>The <code>GeneSetDb</code> tracks metadata about genesets at <strong>the collection</strong>
level. This means that we assume that all of the <code>feature_id</code>'s used
within a collection use the same type of feature identifier (such as
a <code><a href="https://rdrr.io/pkg/GSEABase/man/GeneIdentifierType-constructors.html" class="external-link">GSEABase::EntrezIdentifier()</a></code>, were defined in the same organism,
etc.</p>
<p><strong>Please refer to the "GeneSetDb" section of the vignette</strong> for more
details regarding the construction and querying of a <code>GeneSetDb</code> object.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">GeneSetDb</span><span class="op">(</span><span class="va">x</span>, featureIdMap <span class="op">=</span> <span class="cn">NULL</span>, collectionName <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p>A <code>GeneSetCollection</code>, a "two deep" list of either
<code>GeneSetCollection</code>s or lists of character vectors, which are
the gene identifers. The "two deep" list represents the different
collections (top level) at the top level, and each such list is a named
list itself, which represents the gene sets in the given collection.</p></dd>
<dt>featureIdMap</dt>
<dd><p>A data.frame with  2 character columns. The first
column is the ids of the genes (features) used to identify the genes in
<code>gene.sets</code>, the second second column are IDs that this should be mapped
to. Useful for testing probelevel microarray data to gene level gene set
information.</p></dd>
<dt>collectionName</dt>
<dd><p>If <code>x</code> represents a singular collection, ie.
a single <code>GeneSetCollection</code> or a "one deep" (named (by geneset))
list of genesets, then this parameter provides the name for the
collection. If <code>x</code> is multiple collections, this can be character
vector of same length with the names. In all cases, if a collection name
can't be defined from this, then collections will be named anonymously.
If a value is passed here, it will overide any names stored in the list of
<code>x</code>.</p></dd>
<dt>...</dt>
<dd><p>these aren't used for anything in particular, but are here to
catch extra arguments that may get passed down if this function is part
of some call chain.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A GeneSetDb object</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The functionality in the class is useful for the functionality in this
package, but for your own personal usage, you probably want a <code>{BiocSet}</code>.</p>
    </div>
    <div id="slots">
    <h2>Slots</h2>
    

<dl><dt><code>table</code></dt>
<dd><p>The "gene set table": a data.table with geneset information,
one row per gene set. Columns include collection, name, N, and n. The end
user can add more columns to this data.table as desired. The actual
feature IDs are computed on the fly by doing a <code>db[J(group, id)]</code></p></dd>


<dt><code>db</code></dt>
<dd><p>A <code>data.table</code> to hold all of the original geneset id
information that was used to construct this <code>GeneSetDb</code>.</p></dd>


<dt><code>featureIdMap</code></dt>
<dd><p>Maps the ids used in the geneset lists to the ids
(rows) over the expression data the GSEA is run on</p></dd>


<dt><code>collectionMetadata</code></dt>
<dd><p>A <code>data.table</code> to keep metadata about each
individual geneset collection, ie. the user might want to keep track of
where the geneset definitions come from. Perhaps a function that parses
the collection,name combination to generate an URL that points the user
to more information about that geneset, etc.</p></dd>


</dl></div>
    <div id="genesetdb-construction">
    <h2>GeneSetDb Construction</h2>
    


<p>The <code>GeneSetDb()</code> constructor is sufficiently flexible enough to create
a <code>GeneSetDb</code> object from a variety of formats that are commonly used
in the bioconductor echosystem, such as:</p><ul><li><p><code><a href="https://rdrr.io/pkg/GSEABase/man/GeneSetCollection-methods.html" class="external-link">GSEABase::GeneSetCollection()</a></code>: If you already have a <code>GeneSetCollection</code>
on your hands, you can simply pass it to the <code>GeneSetDb()</code> constructor.</p></li>
<li><p>list of ids: This format is commonly used to define gene sets in the
edgeR/limma universe for testing with camera, roast, romer, etc. The names
of the list items are the gene set names, and their values are a character
vector of gene identifiers. When it's a single list of lists, you must
provide a value for <code>collectionName</code>. You can embed multiple
collections of gene sets by having a three-deep list-of-lists-of-ids.
The top level list define the different collections, the second level
are the genesets, and the third level are the feature identifiers for
each gene set. See the examples for clarification.</p></li>
<li><p>a <code>data.frame</code>-like object: To keep track of your own custom gene sets, you
have probably realized the importance of maintaing your own sanity, and
likely have gene sets organized in a table like object that has something
like the <code>collection</code>, <code>name</code>, and <code>feature_id</code> required for a <code>GeneSetDb</code>.
Simply rename the appropriate columns to the ones prescribed here, and pass
that into the constructor. Any other additional columns (symbol, direction,
etc.) will be copied into the <code>GeneSetDb</code>.</p></li>
</ul></div>
    <div id="interrogating-a-genesetdb">
    <h2>Interrogating a GeneSetDb</h2>
    


<p>You might wonder what gene sets are defined in a <code>GeneSetDb</code>: see
the <code><a href="geneSets.html">geneSets()</a></code> function.</p>
<p>Curious about what features are defined in your <code>GeneSetDb</code>? See
the <code><a href="featureIds.html">featureIds()</a></code> function.</p>
<p>Want the details of a particular gene set? Try the <code><a href="geneSet.html">geneSet()</a></code> function.
This will return a <code>data.frame</code> of the gene set definition. Calling
<code><a href="geneSet.html">geneSet()</a></code> on a <code><a href="SparrowResult.html">SparrowResult()</a></code> will return the same <code>data.frame</code> along
with the differential expression statistics for the individual members of the
geneSet across the contrast that was tested in the <code><a href="seas.html">seas()</a></code> call that
created the <code><a href="SparrowResult.html">SparrowResult()</a></code>.</p>
    </div>
    <div id="genesetdb-manipulation">
    <h2>GeneSetDb manipulation</h2>
    


<p>You can subset a GeneSetDb to include a subset of genesets defined in it.
To do this, you need to provide an indexing vector that is as long as
<code>length(gdb)</code>, ie. the number of gene sets defined in GeneSetDb. You
can construct such a vector by performing your boolean logic over the
<code>geneSets(gdb)</code> table.</p>
<p>Look at the Examples section to see how this works, where we take the
MSIgDB c7 collection (aka. "ImmuneSigDB") and only keep gene sets that
were defined in experiments from mouse.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="conversion.html">?conversion</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="co">## exampleGeneSetDF provides gene set definitions in "long form". We show</span></span>
<span class="r-in"><span class="co">## how this can easily turned into a GeneSetDb from this form, or convert</span></span>
<span class="r-in"><span class="co">## it to other forms (list of features, or list of list of features) to</span></span>
<span class="r-in"><span class="co">## do the same.</span></span>
<span class="r-in"><span class="va">gs.df</span> <span class="op">&lt;-</span> <span class="fu"><a href="examples.html">exampleGeneSetDF</a></span><span class="op">(</span><span class="op">)</span></span>
<span class="r-in"><span class="va">gdb.df</span> <span class="op">&lt;-</span> <span class="fu">GeneSetDb</span><span class="op">(</span><span class="va">gs.df</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## list of ids</span></span>
<span class="r-in"><span class="va">gs.df</span><span class="op">$</span><span class="va">key</span> <span class="op">&lt;-</span> <span class="fu"><a href="gskey.html">encode_gskey</a></span><span class="op">(</span><span class="va">gs.df</span><span class="op">)</span></span>
<span class="r-in"><span class="va">gs.list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span><span class="va">gs.df</span><span class="op">$</span><span class="va">feature_id</span>, <span class="va">gs.df</span><span class="op">$</span><span class="va">key</span><span class="op">)</span></span>
<span class="r-in"><span class="va">gdb.list</span> <span class="op">&lt;-</span> <span class="fu">GeneSetDb</span><span class="op">(</span><span class="va">gs.list</span>, collectionName<span class="op">=</span><span class="st">'custom-sigs'</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## A list of lists, where the top level list splits the collections.</span></span>
<span class="r-in"><span class="co">## The name of the collection in the GeneSetDb is taken from this top level</span></span>
<span class="r-in"><span class="co">## hierarchy</span></span>
<span class="r-in"><span class="va">gs.lol</span> <span class="op">&lt;-</span> <span class="fu"><a href="conversion.html">as.list</a></span><span class="op">(</span><span class="va">gdb.df</span>, nested<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="co">## examine this list-of lists</span></span>
<span class="r-in"><span class="va">gdb.lol</span> <span class="op">&lt;-</span> <span class="fu">GeneSetDb</span><span class="op">(</span><span class="va">gs.lol</span><span class="op">)</span> <span class="co">## note that collection is set propperly</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## GeneSetDb Interrogation</span></span>
<span class="r-in"><span class="va">gsets</span> <span class="op">&lt;-</span> <span class="fu"><a href="geneSets.html">geneSets</a></span><span class="op">(</span><span class="va">gdb.df</span><span class="op">)</span></span>
<span class="r-in"><span class="va">nkcells</span> <span class="op">&lt;-</span> <span class="fu"><a href="geneSet.html">geneSet</a></span><span class="op">(</span><span class="va">gdb.df</span>, <span class="st">'cellularity'</span>, <span class="st">'NK cells'</span><span class="op">)</span></span>
<span class="r-in"><span class="va">fids</span> <span class="op">&lt;-</span> <span class="fu"><a href="featureIds.html">featureIds</a></span><span class="op">(</span><span class="va">gdb.df</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># GeneSetDb Manipulation ....................................................</span></span>
<span class="r-in"><span class="co"># Subset down to only t cell related gene sets</span></span>
<span class="r-in"><span class="va">gdb.t</span> <span class="op">&lt;-</span> <span class="va">gdb.df</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"T cell"</span>, <span class="fu"><a href="geneSets.html">geneSets</a></span><span class="op">(</span><span class="va">gdb.df</span><span class="op">)</span><span class="op">$</span><span class="va">name</span><span class="op">)</span><span class="op">]</span></span>
<span class="r-in"><span class="va">gdb.t</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ===============================================================================</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GeneSetDb with 2 defined genesets across 1 collections (0 gene sets are active)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Conformed: no</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -------------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     collection        name active  N  n</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1: cellularity T cells CD4  FALSE 15 NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2: cellularity T cells CD8  FALSE 15 NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -------------------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GeneSetDb with 2 defined genesets across 1 collections (0 gene sets are active)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Conformed: no</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ===============================================================================</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Steve Lianoglou, Denali Therapeutics, Genentech.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

      </footer></div>

  


  

  </body></html>

